USE DATABASE DATAWAREHOUSE

-- Top 10 customers by total sales
SELECT
  C.CUSTOMER_KEY,
  C.FIRST_NAME,
  C.LAST_NAME,
  C.COUNTRY,
  SUM(F.SALES_AMOUNT) AS total_sales
FROM GOLD.FACT_SALES F
JOIN GOLD.DIM_CUSTOMERS C
  ON F.CUSTOMER_KEY = C.CUSTOMER_KEY
GROUP BY C.CUSTOMER_KEY, C.FIRST_NAME, C.LAST_NAME, C.COUNTRY
ORDER BY total_sales DESC
LIMIT 10;


-- Sales by product category
SELECT
  P.CATEGORY,
  P.SUBCATEGORY,
  SUM(F.SALES_AMOUNT) AS total_sales,
  SUM(F.QUANTITY) AS total_qty
FROM GOLD.FACT_SALES F
JOIN GOLD.DIM_PRODUCTS P
ON F.PRODUCT_KEY = P.PRODUCT_KEY
GROUP BY P.CATEGORY, P.SUBCATEGORY
ORDER BY total_sales DESC;


-- Monthly sales trend
SELECT DATE_TRUNC('month', F.ORDER_DATE) AS month, SUM(F.SALES_AMOUNT) AS total_sales
FROM GOLD.FACT_SALES F GROUP BY DATE_TRUNC('month', F.ORDER_DATE)
ORDER BY month;
